<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>文学原型测试 | 灵魂手稿</title>
    
    <script src="https://fastly.jsdelivr.net/npm/react@18/umd/react.production.min.js"></script>
    <script src="https://fastly.jsdelivr.net/npm/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://fastly.jsdelivr.net/npm/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://fastly.jsdelivr.net/npm/chart.js"></script>
    <script src="https://fastly.jsdelivr.net/npm/html2canvas@1.4.1/dist/html2canvas.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Serif+SC:wght@200;500;700&display=swap" rel="stylesheet">

    <style>
        :root { --bg-color: #f2f0e9; --text-main: #3a3833; }
        body {
            font-family: 'Noto Serif SC', serif;
            background-color: var(--bg-color);
            color: var(--text-main);
            -webkit-font-smoothing: antialiased;
            margin: 0;
        }
        .animate-fade-in { animation: fadeIn 0.8s cubic-bezier(0.16, 1, 0.3, 1) forwards; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
        
        .highlight-yellow { background: linear-gradient(180deg, rgba(255,255,255,0) 65%, #e8ed2a 65%); padding: 0 4px; }
        .vertical-text { writing-mode: vertical-rl; text-orientation: mixed; }
        
        .redeem-input {
            background: transparent; border: none; border-bottom: 1.5px solid #3a3833;
            outline: none; text-align: center; letter-spacing: 0.2em; transition: all 0.3s;
        }
        .redeem-input:focus { border-bottom: 2px solid #35afcb; }
        .shake { animation: shake 0.4s ease-in-out; }
        @keyframes shake { 0%, 100% { transform: translateX(0); } 25% { transform: translateX(-5px); } 75% { transform: translateX(5px); } }

        .abstract-node { transition: all 0.3s ease; cursor: pointer; pointer-events: all; }
        .abstract-node:hover { transform: scale(1.1); }
        ::-webkit-scrollbar { width: 0px; background: transparent; }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useRef } = React;

        const COLORS = {
            bg: "#f2f0e9", textMain: "#3a3833", textSecondary: "#6d6b64",
            accentYellow: "#e8ed2a", accentBlue: "#35afcb", accentGreen: "#a4c29b", border: "#dcd8cf"
        };

        const Icon = ({ name, size = 24, className = "" }) => {
            const paths = {
                ChevronRight: "M9 18l6-6-6-6", 
                RefreshCw: "M23 4v6h-6M1 20v-6h6M3.51 9a9 9 0 0114.85-3.36L23 10M1 14l4.64 4.36A9 9 0 0020.49 15",
                Quote: "M3 21c3 0 7-1 7-8V5c0-1.25-.75-2-2-2H3c-1.25 0-2 .75-2 2v7c0 1.25.75 2 2 2 0 4-1 6-2 6zm11 0c3 0 7-1 7-8V5c0-1.25-.75-2-2-2h-5c-1.25 0-2 .75-2 2v7c0 1.25.75 2 2 2 0 4-1 6-2 6z",
                ArrowLeft: "M19 12H5M12 19l-7-7 7-7", 
                ArrowRight: "M5 12h14M12 5l7 7-7 7",
                BookOpen: "M2 3h6a4 4 0 014 4v14a3 3 0 00-3-3H2z M22 3h-6a4 4 0 00-4 4v14a3 3 0 013-3h7z",
                Layers: "M12 2L2 7l10 5 10-5-10-5z M2 17l10 5 10-5 M2 12l10 5 10-5",
                Download: "M21 15v4a2 2 0 01-2 2H5a2 2 0 01-2-2v-4 M7 10l5 5 5-5 M12 15V3",
                Bookmark: "M19 21l-7-5-7 5V5a2 2 0 012-2h10a2 2 0 012 2z",
                History: "M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z",
                Compass: "M12 22a10 10 0 100-20 10 10 0 000 20zm0-10l4-4-4 4-4-4 4 4z",
                X: "M18 6L6 18M6 6l12 12"
            };
            return (
                <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}>
                    <path d={paths[name] || ""} />
                </svg>
            );
        };

        const WRITER_DATA = {
            "鲁迅": { theme: "#b91c1c", secondary: "#1a1a1a", sub: "黑暗深处的睁眼者", status: "启蒙者 / 骨相冷硬", tags: ["国民性解剖", "铁屋呐喊"], quote: "横眉冷对千夫指，俯首甘为孺子牛。", stats: [98, 50, 70, 50, 85], identity: "你在虚假的和平面前选择拆穿，哪怕真相令人不安。", bio: "中国现代文学的开山鼻祖。鲁迅以文字为投枪，解剖民族灵魂。他在冷峻的真实中，撕开了虚伪的温情面纱，在绝望中确立了‘睁眼看’的尊严。", motif: "铁屋之呐喊：即便必死也要觉醒，觉醒本身即是拯救。", anxiety: "害怕由于中庸的妥协而陷入精神的彻底麻木。", shadow: "极度的批判可能演化为对他人的不信任感。", longDesc: "你的人生是一场自我解剖。你拒绝修辞的矫饰，文字里流淌着的是更具痛感的生命。", books: [{title: "《呐喊》", author: "鲁迅", desc: "在铁屋子中发出的第一声呼唤。"}] },
            "张爱玲": { theme: "#4338ca", secondary: "#1e1b4b", sub: "华丽废墟的守望者", status: "洞察者 / 苍凉底色", tags: ["海派传奇", "世俗物哀"], quote: "生命是一袭华丽的袍，爬满了蚤子。", stats: [50, 95, 45, 65, 55], identity: "你在琐碎日常的折痕里看穿命运。你在繁华中捕捉腐朽。", bio: "现代文学史上最不可忽视的异类。她在华丽中捕捉腐朽，在繁华中看穿幻灭。张爱玲专攻人性深处的自私与尴尬，将世俗悲剧写到了极致。", motif: "华丽袍子上的虱子：美与丑在苍凉底色下达成凄凉共振。", anxiety: "害怕在时间的荒野里被世界彻底抛弃。", shadow: "过度的苍凉感使你的人生显得极其疏离。", longDesc: "你在琐碎和平庸中发现宿命的荒诞。拒绝宏大叙事，只在时间的折痕里捕捉华丽的腐朽。", books: [{title: "《传奇》", author: "张爱玲", desc: "在旧梦中寻找真实。"}] },
            "王小波": { theme: "#1d4ed8", secondary: "#1e3a8a", sub: "智性趣味的自由者", status: "理侠 / 智性趣味", tags: ["反抗愚昧", "逻辑美学"], quote: "一个人只拥有此生此世是不够的。", stats: [88, 98, 65, 90, 75], identity: "你用逻辑消解崇高，认为有趣是人作为主体的底线。", bio: "当代文坛最独特的自由主义者。他将诗意与逻辑融合，以漫不经心的姿态解构权教条。在他看来，‘有趣’是独立主体最重要的防线。", motif: "诗意世界之反抗：智性的趣味比崇高的口号更具救赎力量。", anxiety: "害怕由于规则的愚昧而丧失个人精神的自主性。", shadow: "智性的优越感有时会演变为对他人的冷嘲。", longDesc: "你拒绝任何形式的愚昧。你在荒谬中保持着诚实的幽默感，致力于在无趣的世界里开辟自由疆域。", books: [{title: "《黄金时代》", author: "王小波", desc: "浪漫主义与逻辑的奇妙结合。"}] },
            "沈从文": { theme: "#0891b2", secondary: "#164e63", sub: "流水与人性的纪录者", status: "造梦人 / 自然原力", tags: ["湘西神话", "人性本真"], quote: "我爱过一个正当最好年龄的人。", stats: [50, 60, 85, 95, 45], identity: "你在物质文明的噪音中退守河边，礼赞原始人性。", bio: "来自湘西凤凰的文学赤子。他用白描的笔法构建了一个未经污染的人性圣殿。在都市喧嚣外，礼赞原始生命力的纯粹与哀伤。", motif: "自然法则高于社会逻辑：流水带走野花，藏着宇宙最丰饶的真相。", anxiety: "害怕由于都市文明的入侵而丧失人性的纯粹。", shadow: "过度的自然主义可能导致对现实残酷性的消解。", longDesc: "你迷恋自然的纯粹。你认为文学不应只有斗争，还应有对情感自然的敬畏与描摹。", books: [{title: "《边城》", author: "沈从文", desc: "在湘西烟雨中寻找纯净人性。"}] },
            "史铁生": { theme: "#4b5563", secondary: "#111827", sub: "生命局限的静思者", status: "静思者 / 灵魂突围", tags: ["地坛哲思", "死亡契约"], quote: "死是一个必然会降临的节日。", stats: [80, 90, 60, 50, 98], identity: "你在废墟上思考生存，在精神上完成了对肉身的突围。", bio: "在地坛的残垣断壁间，他完成了对存在局限的终极追问。史铁生是在用病弱躯壳与死神博弈，并在精神上完成了辉煌突围。", motif: "死是一个必然的节日：在必然的局限中，创造出无限宽广的精神空间。", anxiety: "害怕由于身体的残缺而丧失与世界连接的可能。", shadow: "深度的哲思有时会带有一种沉重的宗教仪式感。", longDesc: "你承认肉身的局限。你与死亡达成默契，获得了生的宁静。文学是对生命意义的终极追问。", books: [{title: "《我与地坛》", author: "史铁生", desc: "关于生命意义的终极追问。"}] },
            "萧红": { theme: "#7c3aed", secondary: "#4c1d95", sub: "呼兰河畔的漂泊灵性", status: "漂泊者 / 野生灵性", tags: ["东北荒野", "洛神遗风"], quote: "那是呼兰河传，那是我的小城故事。", stats: [75, 50, 85, 98, 65], identity: "你有野生的直觉，在荒凉岁月里记录孤独与灵性。", bio: "被誉为‘文学洛神’的天才女性。她的一生是一场仓皇的迁徙，文字是对这迁徙阵痛最敏锐的捕捉。生命粗砺如泥，却透着神辉。", motif: "生死场上的颤动：人类卑微且顽强地生灭，原始野性是文学本质。", anxiety: "害怕被由于某种定居的状态而丧失灵魂的野性。", shadow: "过度的漂泊感可能使人生在现实层面无法落脚。", longDesc: "你在荒凉的岁月里行走。生命如同一场没有终点的迁徙。你的文字充满了原始的战栗感。", books: [{title: "《呼兰河传》", author: "萧红", desc: "用灵性的笔调勾勒生命长卷。"}] },
            "曹雪芹": { theme: "#ca8a04", secondary: "#713f12", sub: "大观园的织梦人", status: "织梦人 / 繁华幻灭", tags: ["红楼梦", "东方挽歌"], quote: "质本洁来还洁去，强于污淖陷渠沟。", stats: [40, 75, 55, 45, 98], identity: "你洞穿了万物的覆灭，却依然沉醉于记录那一抹华丽。", bio: "中国古典文学终极高峰。他在幻梦中预演文明覆灭，实现了从世俗说书到生命美学总结的伟大质变，写就关于‘美’的永恒祭奠。", motif: "质本洁来还洁去：在必将到来的崩坏前，记录那一抹瞬间华丽。", anxiety: "害怕极致的美在俗世的权力争夺中瞬间消亡。", shadow: "透彻的宿命感容易使人生陷入虚无的终局。", longDesc: "你在字里行间构建幻梦。", books: [{title: "《红楼梦》", author: "曹雪芹", desc: "东方美学的集大成之作。"}] },
            "杨绛": { theme: "#166534", secondary: "#064e3b", sub: "洗净铅华的观察家", status: "观察家 / 洁白克制", tags: ["洗炼文风", "生命智慧"], quote: "我们仨，就剩下我一个了。", stats: [35, 92, 45, 55, 90], identity: "你在平淡中见真意，力量源于内心的安静与坚韧。", bio: "文坛最宁静的女性声音。在经历世纪波澜后，用最洁白的笔触记录温润情感。文字没有多余盐分，却饱含生命智慧。", motif: "洗净铅华见真意：在喧嚣边缘守住灯火与书卷，是对时代最温柔的反抗。", anxiety: "害怕过于外向的喧嚣破坏了内心的专注。", shadow: "过度的克制显得对外部冲突缺乏热量。", longDesc: "你在经历了世纪动荡后选择克制。文字是记录温度的日记。", books: [{title: "《我们仨》", author: "杨绛", desc: "极简文字下的深情力量。"}] },
            "林徽因": { theme: "#be185d", secondary: "#701a75", sub: "纯净审美的构建者", status: "建筑师 / 纯净审美", tags: ["现代派诗歌", "理性结构"], quote: "你是人间的四月天，笑响点亮了四面风。", stats: [35, 75, 50, 55, 95], identity: "你在理性的建筑与感性的诗歌间寻找高贵的平衡。", bio: "动荡时代的建筑师与诗人。用理性框架支撑起感性审美圣殿。追求词藻纯净与精神轻盈，是混乱时代的一抹微光。", motif: "废墟上的优雅：审美是人最后的尊严，用优雅构建内心理想国。", anxiety: "害怕外部战乱与动荡毁灭了内心的圣殿。", shadow: "对纯净的追求使你无法直视现实的脓疮。", longDesc: "你守护着审美，认为那是最后的尊严。你在动荡中寻求秩序。", books: [{title: "《你是人间的四月天》", author: "林徽因", desc: "在理性与感性之间捕捉理想。"}] },
            "三毛": { theme: "#ea580c", secondary: "#7c2d12", sub: "流浪的存在主义者", status: "实验员 / 浪漫流浪", tags: ["撒哈拉往事", "远方自我"], quote: "如果你给我的，和你给别人的一样，那我就不要了。", stats: [88, 45, 75, 98, 65], identity: "你将生命过成实验，在不断的行走中去发明自我。", bio: "拒绝被任何社会角色定义。她在行走中发明了‘真我’。文字是狂风、是黄沙、是烈火，唤醒整整一代人对远方的渴望。", motif: "身份在路上创造：自由是灵魂唯一的燃料，拒绝平庸的定居。", anxiety: "害怕被任何人定义，害怕任何形式的安稳定居。", shadow: "极致的自我中心导致与真实社会的脱节。", longDesc: "你拒绝平庸。你的文字带有异域的狂风。你在远方寻找自己的姓名。", books: [{title: "《撒哈拉的故事》", author: "三毛", desc: "对自由最赤裸的呼唤。"}] },
            "钱钟书": { theme: "#0f766e", secondary: "#134e4a", sub: "围城外的冷眼审视者", status: "冷眼人 / 智性巅峰", tags: ["博通中外", "围城困局"], quote: "城外的人想冲进去，城里的人想出来。", stats: [40, 98, 35, 85, 60], identity: "你追求绝对智性，对文明的尴尬有着精准的解剖。", bio: "现代学人小说巅峰。以博通中外视野俯视众生，对人类文明的‘尴尬’有着毒舌般的精准洞察。文字是场智力盛宴。", motif: "围城的死循环：城内外的人相互观望，这种结构性荒谬是人类的宿命。", anxiety: "害怕由于过于博学陷入无法行动的‘书斋困局’。", shadow: "毒舌的快感可能掩盖了对生命温度的感知。", longDesc: "你享受博学的孤独。文学是智力博弈的游乐场，是对知识分子的反讽。", books: [{title: "《围城》", author: "钱钟书", desc: "智性叙事的巅峰。"}] },
            "丁玲": { theme: "#15803d", secondary: "#064e3b", sub: "时代漩涡中的抉择者", status: "抉择者 / 时代激荡", tags: ["女性主体", "自我解放"], quote: "人，只要有一种信念，有所追求，就能忍受。", stats: [92, 65, 55, 50, 95], identity: "你敢于在冲突中直面自我，在历史阵痛中挣扎进化。", bio: "剧烈挣扎的先锋女性。人生是一次次剧烈重组，文字展现了强韧主体性，在时代漩涡中寻找真实的自我。", motif: "信念的韧度：自我解放不是目的，而是投身宏大进程的起点。", anxiety: "害怕由于过于关注小我而丧失对正义的参与。", shadow: "时代的狂热可能在某些瞬间掩盖了个体真实。", longDesc: "你是投身的火，也是灼烧的铁。展现了极强韧的生命力。", books: [{title: "《太阳照在桑干河上》", author: "丁玲", desc: "宏大进程中的个体阵痛。"}] },
            "王安忆": { theme: "#be185d", secondary: "#701a75", sub: "城市日常的织梦人", status: "织梦人 / 城市肌理", tags: ["海派传人", "弄堂逻辑"], quote: "在繁华的尘埃里，寻找人世的逻辑。", stats: [45, 90, 75, 55, 80], identity: "你迷恋细枝末节的厚度，在喧嚣中编织情感逻辑。", bio: "文坛最具耐性的工笔画家。在弄堂细碎逻辑中缝制史诗，探讨城市精神的延续与断裂，具有极具世俗厚度的民间史感。", motif: "寻找人世的逻辑：城市的灵魂藏在琐碎至极的生存博弈中。", anxiety: "害怕城市精神在商业化洪流中丧失逻辑感。", shadow: "过于绵密的细节描写消解了叙事爆发力。", longDesc: "你认为文学是工笔画。在弄堂里绣出史诗，重塑了城市的叙事逻辑。", books: [{title: "《长恨歌》", author: "王安忆", desc: "上海弄堂里的情感史诗。"}] },
            "残雪": { theme: "#581c87", secondary: "#2e1065", sub: "潜意识的实验员", status: "梦游者 / 潜意识深渊", tags: ["先锋极致", "异化噩梦"], quote: "在极致的纯粹中，寻找灵魂的出口。", stats: [98, 45, 98, 85, 75], identity: "你拒绝与外部现实和解，专攻内部世界的异化感。", bio: "中国先锋文学中最顽强的存在。彻底切断外部现实反映论，专攻内部异化与噩梦，是文学中最令人战栗的异类。", motif: "潜意识的故乡：现实只是影子，文字是通向黑暗唯一的出口。", anxiety: "害怕外界频繁的接触干扰了梦境的纯粹。", shadow: "彻底的自我封闭使文字充满了战栗的孤独。", longDesc: "你的文字是通向内部深渊的秘径。你是文学中最尖锐的异类。", books: [{title: "《黄泥街》", author: "残雪", desc: "开启东方先锋文学的奇诡梦境。"}] },
            "迟子建": { theme: "#0369a1", secondary: "#082f49", sub: "冰雪大地的守火者", status: "守火者 / 自然悲悯", tags: ["黑土地", "温情现实"], quote: "在寒冷的北方，灵魂也会开出温暖的花。", stats: [40, 70, 88, 92, 85], identity: "你坚信自然的法则高于社会，在极寒中守望温存。", bio: "扎根冰雪大地的守火人。用神性笔触记录少数民族兴衰。文字如冬夜油灯，散发出阔大且悲悯的自然精神。", motif: "自然法则的神圣：严寒中守望最后的人性善良，是生命对土地的告白。", anxiety: "害怕古老的自然文明被现代铁骑踏碎。", shadow: "过度的怀旧色有时美化了边缘文明苦难。", longDesc: "你扎根北方边缘。文学是漫长冬夜里的一盏油灯。", books: [{title: "《额尔古纳河右岸》", author: "迟子建", desc: "对古老文明的绝美挽歌。" }] },
            "舒婷": { theme: "#e11d48", secondary: "#881337", sub: "独立与温柔的诗人", status: "诗人 / 独立风骨", tags: ["朦胧诗", "感性宣言"], quote: "我必须是你近旁的一株木棉。", stats: [45, 65, 88, 75, 85], identity: "你拥有一种充满力量的温柔。强调自我的独立与平视。", bio: "朦胧诗派核心。在理性复苏的80年代，确立了女性平等的感性宣言。文字既有女性柔韧，又有思想骨气。", motif: "拒绝攀附的共鸣：我必须是你近旁的一株木棉，作为树的形象和你站在一起。", anxiety: "害怕过度情感投入丧失了个体自主性。", shadow: "理性的追求使某些瞬间显得过于清醒。", longDesc: "文学是对人格自主的宣誓，也是生命深情的赞歌。", books: [{title: "《致橡树》", author: "舒婷", desc: "当代情感独立精神的圣经。" }] },
            "莫言": { theme: "#991b1b", secondary: "#450a0a", sub: "民间幻象的通灵者", status: "通灵者 / 大地幻象", tags: ["魔幻现实", "高密原力"], quote: "生死疲劳，从荒原到幻象。", stats: [85, 55, 95, 65, 80], identity: "你将民间的粗砺升华为绚烂幻觉。文字带有腥味。", bio: "文坛最具爆发力的想象者。将民间荒诞编织成魔幻现实. 文字带有泥土腥味与历史挑衅, 挖掘被格式化的生命元神。", motif: "轮回的幻象：权力的宏大叙事下，大地的欲望与牺牲才是永恒。", anxiety: "害怕土地最原始的生命力被现代格式化。", shadow: "血腥与狂想交织可能使感官过载。", longDesc: "挖掘历史最原始的生命力，重构民族的苦难叙事。", books: [{title: "《生死疲劳》", author: "莫言", desc: "东方魔幻现实主义巅峰。"}] },
            "余华": { theme: "#1e293b", secondary: "#020617", sub: "苦难底色的生存者", status: "见证者 / 生存底色", tags: ["苦难叙事", "活着意志"], quote: "活着，活着本身就是唯一的理由。", stats: [75, 85, 50, 60, 98], identity: "你剥离感伤，认为苦难面前唯一的尊严就是忍受。", bio: "剥离感伤书写苦难。揭示生命最原始本能——忍受。‘活着’不再是动词，而是一座沉重庄严的山。", motif: "活着本身即理由：剥离理想后，那个在苦难中耕耘的影子才是真实。", anxiety: "害怕生存的匮乏丧失人的基本属性。", shadow: "冷静到近乎麻木的视角显得冷酷无情。", longDesc: "更关注在那之上的“活着”，那是本能的胜利。", books: [{title: "《活着》", author: "余华", desc: "生存意志的最强音。"}] },
            "金庸": { theme: "#854d0e", secondary: "#451a03", sub: "江湖秩序 of the world", status: "守望者 / 古典大义", tags: ["成人童话", "家国情怀"], quote: "侠之大者，为国为民。", stats: [75, 65, 55, 75, 92], identity: "你在成人世界编织童话。你不仅记录传奇。", bio: "新派武侠宗师. 将通俗文学提升至历史反思高度. 为现代人构建了侠义道德乌托邦, 保留了古典风骨。", motif: "知其不可而为之：在权力阴谋的江湖中, 个体的选择应基于道义责任。", anxiety: "害怕传统侠义精神在现代功利主义面前崩塌。", shadow: "宏大的道德叙事可能忽视了人性的自私。", longDesc: "你在为社会提供另一种想象，文学是浪漫主义的最后阵地。", books: [{title: "《射雕英雄传》", author: "金庸", desc: "侠义精神的现代图腾。"}] },
            "老舍": { theme: "#92400e", secondary: "#451a03", sub: "平民脊梁的守望者", status: "守望者 / 平民脊梁", tags: ["北京地域", "市民宿命"], quote: "活着，这就是生活。", stats: [65, 70, 60, 55, 85], identity: "你扎根大地。你对平凡人的尊严持有深刻的同情。", bio: "京派巨匠. 扎根胡同尘土, 写出民族魂魄史诗. 在市民阶层幽默下, 深藏对传统文明崩塌的悲痛。", motif: "体面生活的脆弱：文明的消失，往往始于平凡人的无声崩裂。", anxiety: "害怕时代的剧变导致文明根基断裂。", shadow: "对故土的依恋转化为某种保守的忧伤。", longDesc: "你在幽默的外壳下记录平民尊严。记录正在消失的文明。", books: [{title: "《四世同堂》", author: "老舍", desc: "民族魂魄的微观史诗。"}] }
        };

        const QUESTIONS = [
            { id: 1, text: "深夜的长街，只有一盏忽明忽暗的路灯。前面的黑暗里似乎蹲着一个影子。你选择：", options: [
                { text: "走过去，哪怕影子是一个深渊，我也要看清它的眼。", target: "鲁迅" },
                { text: "停下来，站在明处冷静计算路灯闪烁的精确频率。", target: "钱钟书" },
                { text: "觉得这一明一暗里藏着某种古老的呼吸，甚至有点美。", target: "沈从文" },
                { text: "绕路走。我只是个普通人，不想参与任何未知的冲突。", target: "老舍" }
            ]},
            { id: 2, text: "你得到一卷已经枯萎的古老手稿。此时你身处闹市，周围全是喧嚣：", options: [
                { text: "在灰尘中嗅出百年前的温润，将其作为余生的避难所。", target: "杨绛" },
                { text: "将其撕碎，洒在空中。让腐朽的文字在风里彻底自由。", target: "残雪" },
                { text: "即便字迹模糊，也要用理性推导出它缺失的所有逻辑。", target: "王小波" },
                { text: "为它举办一场华丽的葬礼，纪念一段正在消失的文明。", target: "曹雪芹" }
            ]},
            { id: 3, text: "暴雨中，你看到一把被遗弃在泥水里的红色丝绸长伞：", options: [
                { text: "捡起它。这抹残破的红，是这污浊世界里唯一的亮色。", target: "张爱玲" },
                { text: "任由雨淋。它本该属于泥土，这种覆灭里有种神圣感。", target: "沈从文" },
                { text: "觉得它像个落魄的英雄。虽然湿透，但骨架依然嶙峋。", target: "金庸" },
                { text: "撑开它。不管它漏不漏，哪怕只能挡住一秒的雨也是道义。", target: "余华" }
            ]},
            { id: 4, text: "一个机器人请你给它解释什么叫“痛苦”，否则它将自毁。你会：", options: [
                { text: "告诉它：痛苦是你确认自己依然“活着”的唯一铁证。", target: "史铁生" },
                { text: "冷笑一声：所谓痛苦，不过是逻辑算法里的一场小感冒。", target: "钱钟书" },
                { text: "剥开胸膛让它看伤疤。文字解释不清，只能用血肉对齐。", target: "丁玲" },
                { text: "教它写一首关于雪地孤鸿的诗。美是消解痛的唯一药方。", target: "林徽因" }
            ]},
            { id: 5, text: "你被流放到一个只有冰雪的无人小镇。你手里只有一盒火柴：", options: [
                { text: "全部擦亮。哪怕只有一瞬，我也要在这极寒里看到光。", target: "三毛" },
                { text: "一根也不用。在黑暗中认领这份极致的孤独与野性。", target: "萧红" },
                { text: "守着它。这是我最后的口粮，每一步都要走得极稳。", target: "迟子建" },
                { text: "在雪地上刻满反叛的咒语。意志比火柴更能对抗严寒。", target: "鲁迅" }
            ]},
            { id: 6, text: "你走进一间满是镜子的房间。你看到成千上万个自己：", options: [
                { text: "逐一审视每一个影子，寻找那个最接近“真我”的裂缝。", target: "鲁迅" },
                { text: "觉得这只是一场高级的视觉恶作剧，带着智性的嘲弄离开。", target: "王小波" },
                { text: "迷恋这层层叠叠的虚幻厚度。觉得镜中人比真人更真实。", target: "残雪" },
                { text: "对着镜子整理领口。无论身处何种幻象，体面是最后的尊严。", target: "老舍" }
            ]},
            { id: 7, text: "你桌上有一盆开得极盛、却散发着腐烂气味的花：", options: [
                { text: "因为它曾经美过，我愿意陪着它直到化为最后一滩泥。", target: "曹雪芹" },
                { text: "剪掉腐坏的部分，用精细的修辞（修剪）让它重获秩序。", target: "林徽因" },
                { text: "凑近闻，觉得这股腥臭里藏着土地最原始、最野蛮的力量。", target: "莫言" },
                { text: "丢掉。逻辑告诉我们，这种已经死亡的虚荣只会污染空气。", target: "钱钟书" }
            ]},
            { id: 8, text: "一列永不停站的火车。你是车厢里唯一的清醒者，其余人都在做梦：", options: [
                { text: "摇醒他们。哪怕醒来后面临的是无尽的荒野与绝望。", target: "鲁迅" },
                { text: "静静看着窗外飞速后退的麦田。这流逝感本身就是史诗。", target: "沈从文" },
                { text: "在车窗雾气上画一张从未见过的地图，指引灵魂的迁徙。", target: "三毛" },
                { text: "计算火车的速度与铁轨的摩擦力，在这封闭系统里找有趣。", target: "王小波" }
            ]},
            { id: 9, text: "如果你灵魂是一件器物，此刻最契合你指尖触感的是：", options: [
                { text: "一枚锈迹斑斑、却依然能刺穿厚茧的旧缝衣针。", target: "杨绛" },
                { text: "一把能在黑夜里切开所有伪善、散发着冷光的解剖刀。", target: "鲁迅" },
                { text: "一个装满了隔夜残茶、边缘已经崩损的青花瓷碗。", target: "老舍" },
                { text: "一支被狂风吹得弯曲、却拒绝被折断的野生羽毛。", target: "萧红" }
            ]},
            { id: 10, text: "假如这个世界正在像纸一样被慢慢折叠、缩小，你会：", options: [
                { text: "在被折入阴影前，刻下最后一道见骨的、对抗遗忘的痕迹。", target: "余华" },
                { text: "优雅地坐在那道折痕上。这崩塌的几何感具有理性的美。", target: "钱钟书" },
                { text: "随着纸张一同卷曲。在大地的褶皱里寻找原始的温存。", target: "迟子建" },
                { text: "在彻底缩减前，背起包跳向那个尚未被折叠的、未知的远方。", target: "三毛" }
            ]},
            { id: 11, text: "你被要求为你的“敌人”写一段墓志铭。你的笔触倾向于：", options: [
                { text: "精准、辛辣。用一句话揭露他一生所有体面的尴尬。", target: "钱钟书" },
                { text: "庄严。即便道不同，也要给予一个生命最基本的厚重注脚。", target: "史铁生" },
                { text: "带血。让他即便埋入地下，也要在文字的烈火中被审判。", target: "鲁迅" },
                { text: "慈悲。觉得他和路边的野草一样，都是自然的无奈与生灭。", target: "沈从文" }
            ]},
            { id: 12, text: "你在尘土飞扬的工位上，发现了一只断了半个翅膀的蜻蜓。你会：", options: [
                { text: "感到一种原始的、生理性的战栗。这残损里藏着神性。", target: "残雪" },
                { text: "怜悯它。因为它让我想起了这个系统中每一个被磨损的人。", target: "老舍" },
                { text: "把它放在手心，看它挣扎。觉得这种求生欲本身就是黄金。", target: "余华" },
                { text: "因为它破坏了办公室的整洁秩序，将其轻轻扫入纸篓。", target: "林徽因" }
            ]},
            { id: 13, text: "假如时间可以实体化，你希望它是一张什么样的纸？", options: [
                { text: "一张编织得密不透风的丝网。网住所有弄堂里的琐碎瞬间。", target: "王安忆" },
                { text: "一张潦草、狂气、随风飘向空白处的沙漠草纸。", target: "三毛" },
                { text: "一张被反复揉搓、却带有半透明彩墨质感的先锋宣纸。", target: "残雪" },
                { text: "一张刻满了因果关系图、拒绝任何感性留白的坐标纸。", target: "钱钟书" }
            ]},
            { id: 14, text: "夜晚的旷野，你听到远处传来一声必败的挑战号角：", options: [
                { text: "拔出残破的长剑。即便知道结局是覆灭，也要奔向战场。", target: "金庸" },
                { text: "笑出声。觉得这种由于热血而产生的愚昧极其有趣。", target: "王小波" },
                { text: "在风里捕捉那声号角的音频。这孤独的振动让人心安。", target: "萧红" },
                { text: "关上门窗，继续在那盏小油灯下缝补旧日的温情。", target: "杨绛" }
            ]},
            { id: 15, text: "你看到一个满脸污垢的孩子正对着橱窗里的昂贵蛋糕发呆。此时：", options: [
                { text: "愤怒于这道无形的、吃人的橱窗，想要彻底砸烂它。", target: "丁玲" },
                { text: "深沉感慨。这渴望与匮乏，是生命最赤裸的生存底色。", target: "余华" },
                { text: "下意识地移开目光。我只爱洁净、对称且高雅的画面。", target: "林徽因" },
                { text: "观察他眼底的神态，思考这出世俗悲剧背后的权利逻辑。", target: "王安忆" }
            ]},
            { id: 16, text: "一个老人在大雨中守着一筐已经泡烂的红薯。你会：", options: [
                { text: "买下它。虽然它已经不能吃，但我要买回他的尊严。", target: "老舍" },
                { text: "记录下这一地的红与灰。那是这城市正在流血的伤痕。", target: "萧红" },
                { text: "陪他坐一会儿。雨声与老人的沉默，是此时最沉的文字。", target: "史铁生" },
                { text: "分析。这种低效的生存模式，是由于某种结构性的愚昧。", target: "钱钟书" }
            ]},
            { id: 17, text: "你在一面布满灰尘的镜子里，突然看到了一张全然陌生的脸：", options: [
                { text: "尖叫。那是潜意识里被我杀死的另一个自我活过来了。", target: "残雪" },
                { text: "逼视。我想知道这个陌生的灵魂，是否也有不妥协的风骨。", target: "鲁迅" },
                { text: "淡定。也许这只是宇宙在折叠过程中产生的一个美丽差错。", target: "沈从文" },
                { text: "涂抹。用胭脂或墨迹去覆盖，直到镜面变回我熟悉的平庸。", target: "张爱玲" }
            ]},
            { id: 18, text: "面对一个毫无意义、却被大众盲目崇拜的纪念碑。你会：", options: [
                { text: "写一篇满篇注脚的文章，用智性去拆解它的荒谬地基。", target: "王小波" },
                { text: "在它的阴影里种下一株野草。生命比石头更具颠覆力。", target: "迟子建" },
                { text: "对着它啐一口。这种麻木的崇拜是对清醒者的侮辱。", target: "鲁迅" },
                { text: "把它画进背景。纪念碑只是这苍凉城市景观的一块补丁。", target: "王安忆" }
            ]},
            { id: 19, text: "你被要求定义“爱”。你的第一反应是：", options: [
                { text: "一种在寒冷冬夜里，两团微弱火苗相互交换温度的契约。", target: "迟子建" },
                { text: "我必须是你近旁的一株木棉，作为树的形象和你站在一起。", target: "舒婷" },
                { text: "一场华丽袍子下的博弈。本质是自私者的相互收留。", target: "张爱玲" },
                { text: "一种能让受压迫的灵魂瞬间觉醒、产生反抗勇气的力量。", target: "鲁迅" }
            ]},
            { id: 20, text: "整个文明的图书馆都着火了。你只能从火场里抢救出一页纸：", options: [
                { text: "抢出一张写满了逻辑因果、确保智性不灭的公式纸。", target: "钱钟书" },
                { text: "抢出一张沾满了母亲眼泪、记录了家庭温度的旧书信。", target: "杨绛" },
                { text: "抢出一张空白纸。在废墟之上，我们需要重新认领姓名。", target: "残雪" },
                { text: "抢出一张刻满了斗争史、能点燃下一次革命的火种页。", target: "鲁迅" }
            ]},
            { id: 21, text: "假如文字可以发声。你希望你的书稿发出的声音是：", options: [
                { text: "像铁锤重击铁砧。每一声都带有震碎麻木的力量。", target: "鲁迅" },
                { text: "像深山里的空谷足音。孤独、清远，不求回响。", target: "史铁生" },
                { text: "像弄堂里细密的针脚走线声。琐碎中见大千世界。", target: "王安忆" },
                { text: "像大风刮过沙漠的啸叫。自由得让人感到生理性不适。", target: "三毛" }
            ]},
            { id: 22, text: "胜利的消息传来了。但你发现，所谓的胜利只是换了一种压迫：", options: [
                { text: "毫不意外。在这一场苍凉的闹剧里，虚无才是终极的主题。", target: "张爱玲" },
                { text: "重新拔出投枪。只要黑暗还在，我就永远是那个不服从者。", target: "鲁迅" },
                { text: "退守河边。社会的喧嚣只是浮尘，自然的流水才是真实。", target: "沈从文" },
                { text: "在笔记本里加一个刻薄的批注：这是一场智商欠费的狂欢。", target: "钱钟书" }
            ]},
            { id: 23, text: "你在整理旧物时，发现了一根已经断裂的长发。你会：", options: [
                { text: "感到一种原始的灵性颤动。觉得发丝里缠绕着旧梦。", target: "萧红" },
                { text: "将其精心包裹，收进一个洁白的信封里。这是我的圣地。", target: "杨绛" },
                { text: "通过发质分析。推导这根头发的主人当年的营养与处境。", target: "王小波" },
                { text: "直接扔掉。断裂的东西没有美感，不值得进入我的档案。", target: "林徽因" }
            ]},
            { id: 24, text: "面对厚重得让人窒息的传统规矩。你的本能反应是：", options: [
                { text: "背负着这沉重的遗产。在废墟里，做一个古典的守望者。", target: "老舍" },
                { text: "冷静解剖。将这些腐烂的符号转化成现代叙事的砖石。", target: "钱钟书" },
                { text: "亲手烧毁它。只有在焦土之上，灵魂才有最广阔的操场。", target: "残雪" },
                { text: "美化它。在词藻里，重构一个从未存在的极致盛世。", target: "林徽因" }
            ]},
            { id: 25, text: "假如生命是一场必败的诉讼。你会：", options: [
                { text: "在绝望的法庭上，发表那篇最凛冽、最不计后果的抗议稿。", target: "鲁迅" },
                { text: "承认主体的局限。用思考去完成这一场肉身的突围。", target: "史铁生" },
                { text: "嘲笑法官的逻辑漏洞。在智性上获得某种俯视的快感。", target: "王小波" },
                { text: "化作漫天飞舞的一枚轻盈羽毛。我拒绝进入任何审判流程。", target: "三毛" }
            ]},
            { id: 26, text: "文学里的“风景”应当具备哪种物理状态？", options: [
                { text: "布满荆棘的荒原。这是试炼英雄骨骼与意志的战道。", target: "鲁迅" },
                { text: "迷雾森林。由无数潜意识隐喻构成的、通往噩梦的线索。", target: "残雪" },
                { text: "半梦半醒的江南。逃离粗糙现实唯一的、湿润的避难所。", target: "曹雪芹" },
                { text: "极北的雪原。守望最后一点温润的、属于人性的善良。", target: "迟子建" }
            ]},
            { id: 27, text: "面对“神秘主义”。你的文学态度倾向于：", options: [
                { text: "“神秘是真相的掩体。我们要用反叛逼它露出原形。”", target: "鲁迅" },
                { text: "“神秘只是理性的边疆。这层迷雾终会被逻辑彻底穿透。”", target: "杨绛" },
                { text: "“神秘是审美的温床。一旦解释清楚了，美也就凋谢了。”", target: "林徽因" },
                { text: "“神秘是永远的地平线。我们追逐它，但从知从未抵达。”", target: "萧红" }
            ]},
            { id: 28, text: "你必须为你的对手选择一种结局。你会：", options: [
                { text: "让他拥有比我更坚定的反抗精神。甚至反过来审判我。", target: "鲁迅" },
                { text: "让他成为我智性的镜像。在永无止境的博弈中寻找有趣。", target: "王小波" },
                { text: "让他成为理想人格的载体。替我在污垢的文字里救赎。", target: "林徽因" },
                { text: "让他成为命运最冷酷的对照组。在毁灭中映照主体尊严。", target: "余华" }
            ]},
            { id: 29, text: "文字在宇宙中最终的物理形态应当是：", options: [
                { text: "一把不熄的火。点燃读者的同时也正在燃尽自己。", target: "鲁迅" },
                { text: "一个完美的圆。首尾相接，逻辑自闭且具有神圣冷感。", target: "杨绛" },
                { text: "一条无限延伸至地平线尽头的、极其模糊的河流直线。", target: "沈从文" },
                { text: "一片在虚空中颤动的野生羽毛。捕捉风的每一次异化。", target: "残雪" }
            ]},
            { id: 30, text: "最后。如果你可以掌握一种虚构的力量，你会：", options: [
                { text: "将苦难提炼成黄金。让那些被侮辱的人获得文学加冕。", target: "莫言" },
                { text: "在日常裂缝中挖深井。去修补那破碎、苍凉的现实。", target: "王安忆" },
                { text: "在空白处发明引力。让所有混乱的逻辑重新归位。", target: "钱钟书" },
                { text: "将世界缩减成一个书柜。而我拥有打开它唯一的钥匙。", target: "杨绛" }
            ]}
        ];

        const AbstractNode = ({ name, isActive, onClick }) => {
            return (
                <g className="abstract-node" onClick={onClick}>
                    <rect x="0" y="0" width="40" height="70" fill="transparent" />
                    <circle cx="20" cy="15" r="3.5" fill={isActive ? "#35afcb" : "#3a383344"} />
                    <path d="M20 18.5 Q22 28 18 38" stroke={isActive ? "#35afcb" : "#3a383344"} strokeWidth="2" fill="none" strokeLinecap="round" />
                    <path d="M19 25 L32 18" stroke={isActive ? "#35afcb" : "#3a383344"} strokeWidth="1.2" fill="none" strokeLinecap="round" />
                    <path d="M18 38 L10 48 L22 52" stroke={isActive ? "#35afcb" : "#3a383344"} strokeWidth="1.2" fill="none" strokeLinecap="round" />
                    <text x="20" y="65" textAnchor="middle" fontSize="9" fill={isActive ? "#3a3833" : "#3a383333"} fontWeight={isActive ? "bold" : "normal"}>{name}</text>
                </g>
            );
        };

        const LiteraryConstellation = ({ onSelect, activeName }) => {
            const radiusX = 140; const radiusY = 120;
            const centerX = 180; const centerY = 160;
            const masters = Object.keys(WRITER_DATA);

            return (
                <svg viewBox="0 0 360 320" className="w-full h-full drop-shadow-sm" style={{ touchAction: 'manipulation' }}>
                    <ellipse cx={centerX} cy={centerY} rx={radiusX} ry={radiusY} fill="none" stroke="#3a3833" strokeWidth="0.5" strokeDasharray="4 4" opacity="0.1" />
                    <g transform="translate(130, 120)" opacity="0.08" style={{mixBlendMode: 'multiply'}}>
                        <path d="M10 40 Q 30 10 70 35 Q 90 60 50 80 Q 20 70 10 40" fill="#a4c29b" /><path d="M25 45 Q 45 15 85 40 Q 105 65 65 85" fill="#35afcb" />
                    </g>
                    {masters.map((name, i) => {
                        const angle = (i / masters.length) * Math.PI * 2 - Math.PI / 2;
                        const x = centerX + Math.cos(angle) * radiusX;
                        const y = centerY + Math.sin(angle) * radiusY;
                        return (
                            <g key={name} transform={`translate(${x - 20}, ${y - 30})`}>
                                <AbstractNode name={name} isActive={activeName === name} onClick={() => onSelect(name)} />
                            </g>
                        );
                    })}
                </svg>
            );
        };

        function App() {
            const [step, setStep] = useState('welcome');
            const [currentQuestion, setCurrentQuestion] = useState(0);
            const [scores, setScores] = useState({});
            const [history, setHistory] = useState([]);
            const [result, setResult] = useState(null);
            const [isSaving, setIsSaving] = useState(false);
            const [selectedWriter, setSelectedWriter] = useState("鲁迅");
            const [code, setCode] = useState("");
            const [showError, setShowError] = useState(false);
            
            const radarCanvas = useRef(null);
            const captureRef = useRef(null);
            const chartRef = useRef(null);

            const handleVerify = () => {
                if (code.toLowerCase().trim() === "qwert") setStep('quiz');
                else { setShowError(true); setTimeout(() => setShowError(false), 500); }
            };

            const handleAnswer = (target) => {
                const newScores = { ...scores, [target]: (scores[target] || 0) + 1 };
                setHistory([...history, { scores, currentQuestion }]);
                setScores(newScores);
                if (currentQuestion < 29) setCurrentQuestion(currentQuestion + 1);
                else {
                    const topWriterName = Object.keys(newScores).reduce((a, b) => (newScores[a] || 0) > (newScores[b] || 0) ? a : b);
                    setResult({ ...WRITER_DATA[topWriterName], name: topWriterName });
                    setStep('result');
                    window.scrollTo(0, 0);
                }
            };

            const handleBack = () => {
                if (history.length > 0) {
                    const last = history[history.length - 1];
                    setScores(last.scores); setCurrentQuestion(last.currentQuestion);
                    setHistory(history.slice(0, -1));
                } else setStep('welcome');
            };

            const handleRestart = () => {
                setStep('welcome'); setCurrentQuestion(0); setScores({}); setHistory([]); setResult(null); setCode("");
                window.scrollTo(0, 0);
            };

            const saveAsImage = async () => {
                if (typeof html2canvas === 'undefined') return;
                setIsSaving(true);
                try {
                    const canvas = await html2canvas(captureRef.current, { scale: 2, backgroundColor: "#f2f0e9", useCORS: true });
                    const link = document.createElement('a');
                    link.download = `灵魂手稿-${result.name}.png`;
                    link.href = canvas.toDataURL('image/png');
                    link.click();
                } catch (err) { console.error(err); }
                setIsSaving(false);
            };

            useEffect(() => {
                if (step === 'result' && result && radarCanvas.current) {
                    if (chartRef.current) chartRef.current.destroy();
                    const ctx = radarCanvas.current.getContext('2d');
                    chartRef.current = new Chart(ctx, {
                        type: 'radar',
                        data: {
                            labels: ['批判意识', '智性逻辑', '审美欲望', '自由意志', '精神强度'],
                            datasets: [{ data: result.stats, backgroundColor: `${result.theme}22`, borderColor: result.theme, borderWidth: 2, pointRadius: 0 }]
                        },
                        options: { scales: { r: { angleLines: { display: false }, grid: { color: 'rgba(0,0,0,0.05)' }, pointLabels: { font: { size: 9, family: 'Noto Serif SC', weight: 'bold' } }, ticks: { display: false }, min: 0, max: 100 } }, plugins: { legend: { display: false } } }
                    });
                }
            }, [step, result]);

            const dossier = WRITER_DATA[selectedWriter];

            return (
                <div className="max-w-xl mx-auto px-4 py-8 relative">
                    {step === 'welcome' && (
                        <div className="animate-fade-in text-center space-y-8">
                            <div className="flex justify-between items-start pt-4">
                                <div className="inline-block px-2 py-0.5 bg-[#3a3833] text-[#f2f0e9] text-[8px] tracking-widest font-sans uppercase">ARCHETYPE ARCHIVE</div>
                                <div className="text-[8px] opacity-30 font-bold uppercase tracking-widest">NO. 2026 / SYSTEM 01</div>
                            </div>
                            
                            <div className="text-left">
                                <h1 className="text-4xl md:text-5xl font-bold tracking-[0.1em] text-[#3a3833]">寻找你的<span className="highlight-yellow ml-2">文学原型</span></h1>
                                <p className="mt-4 text-[9px] text-gray-400 tracking-[0.4em] uppercase font-bold">DIALOGUE WITH 20 MASTERS</p>
                            </div>

                            <div className="w-full relative py-4">
                                <LiteraryConstellation onSelect={setSelectedWriter} activeName={selectedWriter} />
                                <div className="absolute top-[5%] right-0 bg-white px-3 py-1.5 rounded-sm shadow-xl border border-[#dcd8cf] transform rotate-3 max-w-[120px] z-20 pointer-events-none">
                                    <p className="text-[9px] text-[#3a3833] leading-tight font-bold italic">“点击名字，<br/>提取绝密档案。”</p>
                                </div>
                            </div>

                            <div className="border-t-2 border-[#3a3833] pt-8 text-left space-y-6">
                                <div className="flex justify-between items-end">
                                    <div className="space-y-1">
                                        <h2 className="text-4xl font-bold tracking-widest text-[#3a3833]">{selectedWriter}</h2>
                                        <p className="text-[10px] font-bold text-[#35afcb] uppercase tracking-[0.2em]">{dossier.status}</p>
                                    </div>
                                    <div className="flex gap-2">{dossier.tags.map(t => <span key={t} className="text-[8px] border border-[#dcd8cf] px-1.5 py-0.5 opacity-50 font-bold">#{t}</span>)}</div>
                                </div>
                                <div className="space-y-4">
                                    <p className="text-[12px] leading-[1.8] text-[#6d6b64] text-justify font-light">{dossier.bio}</p>
                                    <div className="space-y-1.5">
                                        <h4 className="text-[9px] font-bold uppercase tracking-widest opacity-30 flex items-center gap-2"><div className="w-3 h-[1px] bg-black"></div> 叙事母题 / MOTIF</h4>
                                        <p className="text-[12px] leading-relaxed text-[#3a3833] italic bg-white bg-opacity-50 p-3 border-l-2 border-[#e8ed2a]">{dossier.motif}</p>
                                    </div>
                                </div>
                            </div>

                            <div className="space-y-8 pt-8">
                                <div className={`space-y-4 ${showError ? 'shake' : ''}`}>
                                    <div className="flex flex-col items-center gap-2">
                                        <span className="text-[10px] uppercase tracking-[0.3em] opacity-40 font-bold">通行码认证 / ACCESS CODE</span>
                                        <input type="text" value={code} onChange={(e) => setCode(e.target.value)} className="redeem-input w-48 py-2 text-sm text-center" placeholder="请输入通行码解锁测试" />
                                    </div>
                                </div>
                                <button onClick={handleVerify} className="w-full py-7 bg-[#3a3833] text-white text-[12px] tracking-[0.8em] font-bold shadow-2xl active:scale-95 transition-all">开启漫游 / ENTER</button>
                                <div className="text-[10px] text-gray-400 tracking-[0.3em] pb-12">Curated by @云树cloudtree</div>
                            </div>
                        </div>
                    )}

                    {step === 'quiz' && (
                        <div className="animate-fade-in space-y-8 text-center">
                            <div className="flex justify-between items-center border-b border-[#dcd8cf] pb-4">
                                <button onClick={handleBack} className="flex items-center gap-1 text-[10px] uppercase opacity-40 hover:opacity-100 transition-all">BACK</button>
                                <span className="text-[9px] uppercase text-[#6d6b64] font-bold tracking-widest">Step {String(currentQuestion + 1).padStart(2, '0')} / 30</span>
                                <div className="w-10"></div>
                            </div>
                            <div className="min-h-[140px] flex flex-col items-center justify-center px-4 space-y-4">
                                <h2 className="text-[16px] md:text-[18px] font-normal leading-[1.8] text-[#3a3833] italic text-justify">{QUESTIONS[currentQuestion].text}</h2>
                            </div>
                            <div className="space-y-4 text-left">
                                {QUESTIONS[currentQuestion].options.map((option, idx) => (
                                    <button key={idx} onClick={() => handleAnswer(option.target)} className="w-full p-6 bg-white bg-opacity-70 rounded-[12px] border border-[#dcd8cf] hover:border-[#3a3833] transition-all group active:bg-white text-left">
                                        <span className="text-[14px] text-[#6d6b64] group-hover:text-[#3a3833] leading-relaxed pr-4">{option.text}</span>
                                    </button>
                                ))}
                            </div>
                            <div className="pt-10 flex justify-center"><div className="h-[0.5px] w-48 bg-[#dcd8cf] relative"><div className="h-full bg-[#3a3833] transition-all duration-700" style={{width: `${((currentQuestion+1)/30)*100}%`}}></div></div></div>
                        </div>
                    )}

                    {step === 'result' && result && (
                        <div className="animate-fade-in space-y-8 pb-12">
                            <div ref={captureRef} className="pb-12 bg-[#f2f0e9] overflow-hidden rounded-2xl result-card relative text-left">
                                <div className="p-12 text-center relative overflow-hidden" style={{ background: `linear-gradient(135deg, ${result.theme}, ${result.secondary})` }}>
                                    <div className="absolute top-0 left-0 w-full h-full opacity-10">
                                        <svg width="100%" height="100%" viewBox="0 0 100 100" preserveAspectRatio="none"><path d="M0,0 L100,0 L100,20 Q50,40 0,20 Z" fill="white" /><circle cx="90" cy="10" r="15" fill="white" /></svg>
                                    </div>
                                    <div className="relative z-10 space-y-6">
                                        <div className="flex justify-center mb-2"><div className="px-3 py-1 bg-white bg-opacity-20 text-white text-[8px] tracking-[0.5em] uppercase font-bold border border-white border-opacity-30 rounded-sm">Archive Manuscript No. {Math.floor(Math.random()*10000)}</div></div>
                                        <h2 className="text-5xl md:text-6xl font-bold text-white tracking-[0.2em] text-center">{result.name}</h2>
                                        <div className="space-y-4">
                                            <p className="text-sm text-white italic font-light tracking-[0.5em] opacity-90 text-center">{result.sub}</p>
                                            <div className="flex justify-center gap-3"><span className="px-4 py-1.5 bg-white text-[10px] font-bold uppercase tracking-widest rounded-full shadow-lg" style={{ color: result.theme }}>灵魂契合度 98%</span></div>
                                        </div>
                                    </div>
                                </div>

                                <div className="px-6 -mt-10 relative z-20">
                                    <div className="grid grid-cols-1 md:grid-cols-2 gap-6 bg-white p-8 border border-[#dcd8cf] rounded-3xl shadow-2xl items-center mb-8">
                                        <div className="space-y-4 text-left">
                                            <h4 className="text-[11px] font-bold border-b pb-2 text-[#3a3833] opacity-60 uppercase tracking-widest">基因分析 / ANALYSIS</h4>
                                            <div className="space-y-3 text-[10px]">
                                                <div className="flex justify-between items-center text-gray-400 uppercase"><span>批判意识</span><div className="w-24 h-1 bg-gray-100"><div className="h-full" style={{width: `${result.stats[0]}%`, backgroundColor: result.theme}}></div></div></div>
                                                <div className="flex justify-between items-center text-gray-400 uppercase"><span>智性逻辑</span><div className="w-24 h-1 bg-gray-100"><div className="h-full" style={{width: `${result.stats[1]}%`, backgroundColor: result.theme}}></div></div></div>
                                                <div className="flex justify-between items-center text-gray-400 uppercase"><span>审美欲望</span><div className="w-24 h-1 bg-gray-100"><div className="h-full" style={{width: `${result.stats[2]}%`, backgroundColor: result.theme}}></div></div></div>
                                            </div>
                                        </div>
                                        <div className="aspect-square w-full max-w-[180px] mx-auto"><canvas ref={radarCanvas}></canvas></div>
                                    </div>

                                    <div className="p-8 bg-white border border-[#dcd8cf] rounded-3xl shadow-sm mb-8 space-y-6 relative overflow-hidden text-left">
                                        <div className="flex items-center gap-3 border-b border-gray-50 pb-4"><Icon name="History" size={18} style={{ color: result.theme }} /><span className="text-[11px] font-bold uppercase tracking-[0.3em] text-[#3a3833] opacity-60">文学史回响 / CONTEXT</span></div>
                                        <p className="text-xs text-[#6d6b64] leading-[2.2] text-justify tracking-wide italic">{result.context}</p>
                                    </div>

                                    <div className="relative p-10 bg-white border border-[#dcd8cf] text-center rounded-3xl shadow-sm mb-8">
                                        <p className="text-xl md:text-2xl leading-[1.8] font-medium italic mb-6 text-center"><span className="highlight-yellow">“{result.quote}”</span></p>
                                        <div className="text-[10px] text-[#a4c29b] tracking-widest uppercase font-bold text-center">— {result.name} —</div>
                                    </div>

                                    <div className="space-y-10 px-2 text-left">
                                        <section className="space-y-4">
                                            <h4 className="text-[11px] font-bold uppercase tracking-[0.5em] border-b border-[#dcd8cf] pb-2 text-[#3a3833] opacity-60">精神原色 / THE SELF</h4>
                                            <div className="bg-white p-6 border-l-4 space-y-4" style={{ borderColor: result.theme }}>
                                                <p className="text-[13px] leading-relaxed text-[#6d6b64] italic">“{result.identity}”</p>
                                                <p className="text-[13px] leading-relaxed font-light">{result.longDesc}</p>
                                            </div>
                                        </section>

                                        <section className="space-y-4 text-left">
                                            <h4 className="text-[11px] font-bold uppercase tracking-[0.5em] border-b border-[#dcd8cf] pb-2 text-red-800 opacity-60">核心焦虑与盲区</h4>
                                            <div className="grid grid-cols-1 md:grid-cols-2 gap-4 text-[12px]">
                                                <div className="p-5 bg-red-50 border border-red-100 rounded text-left">
                                                    <div className="font-bold mb-1">主导焦虑</div><div className="opacity-70 text-red-900">{result.anxiety}</div>
                                                </div>
                                                <div className="p-5 bg-gray-50 border border-gray-100 rounded text-left">
                                                    <div className="font-bold mb-1">阴影面</div><div className="opacity-70">{result.shadow}</div>
                                                </div>
                                            </div>
                                        </section>

                                        <section className="space-y-6 text-left">
                                            <h4 className="text-[11px] font-bold uppercase tracking-[0.5em] border-b border-[#dcd8cf] pb-2 text-[#3a3833] opacity-60">进阶书单推荐</h4>
                                            <div className="grid gap-4">
                                                {result.books.map((book, i) => (
                                                    <div key={i} className="bg-white p-6 border border-[#dcd8cf] rounded-xl shadow-sm text-left">
                                                        <h5 className="text-[15px] font-bold mb-1">{book.title}</h5>
                                                        <p className="text-[10px] text-[#a4c29b] font-bold mb-2 uppercase">作者: {book.author}</p>
                                                        <p className="text-xs text-[#6d6b64] italic leading-relaxed opacity-80">{book.desc}</p>
                                                    </div>
                                                ))}
                                            </div>
                                        </section>
                                    </div>
                                </div>
                            </div>

                            <div className="pt-8 space-y-4 text-center px-4">
                                <button onClick={saveAsImage} disabled={isSaving} className="w-full py-6 bg-black text-white text-[11px] font-bold uppercase tracking-[0.6em] shadow-2xl active:scale-95 transition-all rounded-2xl">{isSaving ? "正在生成中..." : "保存手稿报告 / SAVE REPORT"}</button>
                                <button onClick={handleRestart} className="w-full py-6 border border-[#3a3833] text-[#3a3833] text-[11px] font-bold uppercase tracking-[0.6em] hover:bg-[#3a3833] hover:text-white transition-all rounded-2xl">
                                    <Icon name="RefreshCw" size={14} className="inline mr-2" /> 再次校准原型
                                </button>
                            </div>
                        </div>
                    )}
                    <footer className="mt-16 pt-16 border-t border-[#dcd8cf] text-center space-y-4">
                        <p className="text-[10px] tracking-[0.6em] uppercase text-[#3a3833] font-bold opacity-60">© 2026 CURATED BY @云树CLOUDTREE</p>
                    </footer>
                </div>
            );
        }

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>
